^C[janson@localhost koolnet]$ ./ctest -listen="192.168.1.1:80;0.0.0.0:8800"  -user="janson2" -password="janson"
2015/12/20 19:53:12 Got clientId: 0 IP 183.16.171.56
2015/12/20 19:53:12 starting
2015/12/20 19:53:22 create new p2pclient, from= 169 remoteaddrs [192.168.1.8:49348 223.73.106.138:49348 223.73.106.138:35568]
2015/12/20 19:53:22 init pong 183.16.171.56:41257
2015/12/20 19:53:22 resetLocalAddrs: [192.168.1.23:41257 172.17.42.1:41257 183.16.171.56:41257]
2015/12/20 19:53:22 resetLocalAddrs: [192.168.1.23:41257 172.17.42.1:41257 183.16.171.56:41257]
2015/12/20 19:53:22 got from themself [192.168.1.23:41257 172.17.42.1:41257 183.16.171.56:41257] [192.168.1.8:49348 223.73.106.138:49348 223.73.106.138:35568]
2015/12/20 19:53:22 shakeOne To 192.168.1.8:49348
2015/12/20 19:53:22 shakeOne To 223.73.106.138:49348
2015/12/20 19:53:22 shakeOne To 223.73.106.138:35568
2015/12/20 19:53:22 shakeOne To 192.168.1.8:49348
2015/12/20 19:53:22 shakeOne To 223.73.106.138:49348
2015/12/20 19:53:22 shakeOne To 223.73.106.138:35568
2015/12/20 19:53:22 shakeOne To 192.168.1.8:49348
2015/12/20 19:53:22 shakeOne To 223.73.106.138:49348
2015/12/20 19:53:22 shakeOne To 223.73.106.138:35568
2015/12/20 19:53:22 Response notify remote for shake 0
2015/12/20 19:53:27 shakeOne To 192.168.1.8:49348
2015/12/20 19:53:27 shakeOne To 223.73.106.138:49348
2015/12/20 19:53:27 shakeOne To 223.73.106.138:35568
2015/12/20 19:53:27 shakeOne To 192.168.1.8:49348
2015/12/20 19:53:27 shakeOne To 223.73.106.138:49348
2015/12/20 19:53:27 shakeOne To 223.73.106.138:35568
2015/12/20 19:53:27 shakeOne To 192.168.1.8:49348
2015/12/20 19:53:27 shakeOne To 223.73.106.138:49348
2015/12/20 19:53:27 shakeOne To 223.73.106.138:35568


root@OpenWrt:~# tcpdump -i pppoe-wan udp
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on pppoe-wan, link-type LINUX_SLL (Linux cooked), capture size 65535 bytes
19:53:17.227703 IP server18702.teamviewer.com.5938 > 183.16.171.56.41956: UDP, length 16
19:53:17.449721 IP 183.16.171.56.50929 > 10.120.156.200.snmp:  GetNextRequest(27)  E:2699.1.2
19:53:17.934667 IP 183.16.171.56.50753 > public1.alidns.com.domain: 58979+ PTR? 145.179.81.119.in-addr.arpa. (45)
19:53:17.943493 IP public1.alidns.com.domain > 183.16.171.56.50753: 58979 1/0/0 PTR server18702.teamviewer.com. (85)
19:53:18.242199 IP 183.60.56.20.8000 > 183.16.171.56.60690: UDP, length 79
19:53:18.449251 IP 183.16.171.56.50929 > 10.120.156.200.snmp:  GetNextRequest(27)  E:2699.1.2
19:53:18.639500 IP 183.60.56.20.8000 > 183.16.171.56.60690: UDP, length 271
19:53:18.641066 IP 183.16.171.56.60690 > 183.60.56.20.8000: UDP, length 55
19:53:19.077505 IP 183.16.171.56.41956 > server18702.teamviewer.com.5938: UDP, length 16
19:53:21.230239 IP 183.60.56.20.8000 > 183.16.171.56.60690: UDP, length 79
19:53:21.244624 IP server18702.teamviewer.com.5938 > 183.16.171.56.41956: UDP, length 16
19:53:22.695304 IP 183.16.171.56.41257 > 115.28.237.155.18886: UDP, length 19
19:53:22.746713 IP 115.28.237.155.18886 > 183.16.171.56.41257: UDP, length 38
19:53:22.831898 IP 14.215.80.90.35568 > 183.16.171.56.41257: UDP, length 64
19:53:22.846089 IP 14.215.80.90.35568 > 183.16.171.56.41257: UDP, length 64
19:53:22.862183 IP 14.215.80.90.35568 > 183.16.171.56.41257: UDP, length 64
^C19:53:22.915540 IP 183.16.171.56.41257 > 223.73.106.138.49348: UDP, length 65
19:53:22.915665 IP 183.16.171.56.41257 > 223.73.106.138.35568: UDP, length 65
19:53:22.915851 IP 183.16.171.56.4148 > public1.alidns.com.domain: 24388+ PTR? 155.237.28.115.in-addr.arpa. (45)
19:53:22.925663 IP 183.16.171.56.41257 > 223.73.106.138.49348: UDP, length 65
19:53:22.925676 IP 183.16.171.56.41257 > 223.73.106.138.35568: UDP, length 65
19:53:22.935888 IP 183.16.171.56.41257 > 223.73.106.138.49348: UDP, length 65
19:53:22.935899 IP 183.16.171.56.41257 > 223.73.106.138.35568: UDP, length 65
19:53:22.977468 IP 14.215.80.90.35568 > 183.16.171.56.41257: UDP, length 62
19:53:22.987575 IP 14.215.80.90.35568 > 183.16.171.56.41257: UDP, length 62
19:53:22.996470 IP 14.215.80.90.35568 > 183.16.171.56.41257: UDP, length 62
19:53:23.010317 IP 14.215.80.90.35568 > 183.16.171.56.41257: UDP, length 64
19:53:23.026080 IP 14.215.80.90.35568 > 183.16.171.56.41257: UDP, length 64
19:53:23.039657 IP 14.215.80.90.35568 > 183.16.171.56.41257: UDP, length 64
19:53:23.076934 IP 183.16.171.56.41956 > server18702.teamviewer.com.5938: UDP, length 16
19:53:23.415943 IP public1.alidns.com.domain > 183.16.171.56.4148: 24388 NXDomain 0/0/0 (45)
19:53:23.560031 IP 183.60.56.20.8000 > 183.16.171.56.60690: UDP, length 79
19:53:23.605444 IP 183.16.171.56.50929 > 10.120.156.200.snmp:  GetNextRequest(27)  E:2699.1.2
